{"version":3,"sources":["../../../../assets/Script/assets/Script/BalancePassedView.js"],"names":["module","exports","cc","Class","extends","Component","properties","heads","Node","label_time","Label","onLoad","updatePoint","pointId","costTime","Promise","all","Util","getWeChatUserInfo","getWXFriendRanks","then","selfInfo","value","ranklist","selfId","i","length","nickname","nickName","avatarUrl","ranks","updateHeads","catch","console","log","eor","active","getComponent","setPhoto","string","score"],"mappings":";;;;;;AAAA;;;;;;AAEAA,OAAOC,OAAP,GAAiBC,GAAGC,KAAH,CAAS;AACtBC,aAASF,GAAGG,SADU;;AAGtBC,gBAAY;AACRC,eAAO,CAACL,GAAGM,IAAJ,CADC;AAERC,oBAAY,CAACP,GAAGQ,KAAJ;AAFJ,KAHU;;AAQtB;AACAC,YAAQ,kBAAY,CAAE,CATA;;AAWtBC,iBAAa,2BAAiC;AAAA;;AAAA,YAArBC,OAAqB,QAArBA,OAAqB;AAAA,YAAZC,QAAY,QAAZA,QAAY;;AAC1C,aAAKA,QAAL,GAAgBA,QAAhB;AACAC,gBAAQC,GAAR,CAAY,CACRC,eAAKC,iBAAL,EADQ,EAERD,eAAKE,gBAAL,EAFQ,CAAZ,EAGGC,IAHH,CAGQ,iBAAS;AACb,gBAAIC,WAAWC,MAAM,CAAN,CAAf;AACA,gBAAIC,WAAWD,MAAM,CAAN,CAAf;AACA,gBAAI,CAACC,QAAD,IAAa,CAACF,QAAlB,EAA4B;AAC5B,gBAAIG,SAAS,CAAb;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,SAASG,MAA7B,EAAqCD,GAArC,EAA0C;AACtC,oBAAGF,SAASE,CAAT,EAAYE,QAAZ,KAAyBN,SAAS,CAAT,EAAYO,QAArC,IACAL,SAASE,CAAT,EAAYI,SAAZ,KAA0BR,SAAS,CAAT,EAAYQ,SADzC,EACoD;AAChDL,6BAASC,CAAT;AACA;AACH;AACJ;AACD,kBAAKK,KAAL,GAAa,EAAb;AACA,gBAAIN,WAAW,CAAf,EAAkB;AACd,sBAAKM,KAAL,GAAa,CAACP,SAASC,MAAT,CAAD,EAAkBD,SAASC,SAAS,CAAlB,CAAlB,EAAuCD,SAASC,SAAS,CAAlB,CAAvC,CAAb;AACH,aAFD,MAEO,IAAIA,WAAWD,SAASG,MAAT,GAAkB,CAAjC,EAAoC;AACvC,sBAAKI,KAAL,GAAa,CAACP,SAASC,SAAS,CAAlB,CAAD,EAAsBD,SAASC,SAAS,CAAlB,CAAtB,EAA2CD,SAASC,MAAT,CAA3C,CAAb;AACH,aAFM,MAEA;AACH,sBAAKM,KAAL,GAAa,CAACP,SAASC,SAAS,CAAlB,CAAD,EAAsBD,SAASC,MAAT,CAAtB,EAAuCD,SAASC,SAAS,CAAlB,CAAvC,CAAb;AACH;AACD,kBAAKO,WAAL;AACH,SAxBD,EAwBGC,KAxBH,CAwBS,eAAO;AACZC,oBAAQC,GAAR,CAAY,OAAZ,EAAqBC,GAArB;AACH,SA1BD;AA2BH,KAxCqB;;AA0CtBJ,iBAAa,uBAAY;AACrB,aAAK,IAAIN,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AACxB,gBAAI,CAAC,KAAKK,KAAL,CAAWL,CAAX,CAAL,EAAoB;AACpB,iBAAKlB,KAAL,CAAWkB,CAAX,EAAcW,MAAd,GAAuB,IAAvB;AACA,iBAAK7B,KAAL,CAAWkB,CAAX,EAAcY,YAAd,CAA2B,aAA3B,EAA0CC,QAA1C,CAAmD,KAAKR,KAAL,CAAWL,CAAX,EAAcI,SAAjE;AACA,iBAAKpB,UAAL,CAAgBgB,CAAhB,EAAmBc,MAAnB,GAA4B,KAAKT,KAAL,CAAWL,CAAX,EAAce,KAAd,GAAsB,GAAlD;AACH;AACJ;AAjDqB,CAAT,CAAjB","file":"BalancePassedView.js","sourceRoot":"../../../../assets/Script","sourcesContent":["import Util from './Util'\r\n\r\nmodule.exports = cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        heads: [cc.Node],\r\n        label_time: [cc.Label],\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad: function () {},\r\n\r\n    updatePoint: function ({ pointId, costTime }) {\r\n        this.costTime = costTime\r\n        Promise.all([\r\n            Util.getWeChatUserInfo(),\r\n            Util.getWXFriendRanks()\r\n        ]).then(value => {\r\n            let selfInfo = value[0]\r\n            let ranklist = value[1]\r\n            if (!ranklist || !selfInfo) return\r\n            let selfId = 0\r\n            for (let i = 0; i < ranklist.length; i++) {\r\n                if(ranklist[i].nickname === selfInfo[0].nickName\r\n                && ranklist[i].avatarUrl === selfInfo[0].avatarUrl) {\r\n                    selfId = i;\r\n                    break;\r\n                }\r\n            }\r\n            this.ranks = []\r\n            if (selfId === 0) {\r\n                this.ranks = [ranklist[selfId],ranklist[selfId + 1],ranklist[selfId + 2]]\r\n            } else if (selfId === ranklist.length - 1) {\r\n                this.ranks = [ranklist[selfId - 2],ranklist[selfId - 1],ranklist[selfId]]\r\n            } else {\r\n                this.ranks = [ranklist[selfId - 1],ranklist[selfId],ranklist[selfId + 1]]\r\n            }\r\n            this.updateHeads()\r\n        }).catch(eor => {\r\n            console.log('3e = ', eor)\r\n        })\r\n    },\r\n\r\n    updateHeads: function () {\r\n        for (let i = 0; i < 3; i++) {\r\n            if (!this.ranks[i]) break\r\n            this.heads[i].active = true\r\n            this.heads[i].getComponent(\"PhotoPrefab\").setPhoto(this.ranks[i].avatarUrl);\r\n            this.label_time[i].string = this.ranks[i].score + 'å…³';\r\n        }\r\n    },\r\n})\r\n\r\n\r\n\r\n"]}
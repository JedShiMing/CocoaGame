{"version":3,"sources":["../../../assets/assets/DataMain.js"],"names":["RANK_ITEM_HEIGHT","RANK_ITEM_PADDING","PADDING_BOTTOM_H","cc","Class","extends","Component","properties","ranks","Node","RankItemPre","Prefab","Balance","Friend","start","isWxApp","self","wx","onMessage","console","log","data","cmd","active","requestDataFromServer","showFriendPass","showBalancePass","Util","getWXFriendRanks","then","list","renderRank","players","friends","_content","getChildByName","i","length","item","instantiate","addChild","getComponent","setPlayerInfo","avatarUrl","nickname","score","FriendPassedView","updatePoint","pointId","info","BalancePassedView"],"mappings":"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","file":"DataMain.js","sourceRoot":"../../../assets","sourcesContent":["import BalancePassedView from './Script/BalancePassedView'\nimport FriendPassedView from './Script/FriendPassedView'\nimport Util from './Script/Util'\n\nconst RANK_ITEM_HEIGHT = 108;\nconst RANK_ITEM_PADDING = 14;\nconst PADDING_BOTTOM_H = 50;\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        ranks: cc.Node,\n        RankItemPre: cc.Prefab,\n        Balance: cc.Node,\n        Friend: cc.Node\n    },\n\n    start() {\n        if (!this.isWxApp()) {\n            return;\n        }\n        let self = this;\n        wx.onMessage(data => {\n            console.log('收到主域消息', data);\n            if (!data.cmd) {\n                self.ranks.active = false\n                self.Balance.active = false\n                self.Friend.active = false\n            } else if (data.cmd === 2) { // 排行榜\n                console.log('显示排行榜');\n                self.ranks.active = true\n                self.Balance.active = false\n                self.Friend.active = false\n                self.requestDataFromServer();\n            } else if (data.cmd === 3) { // 已通关好友, 右上角\n                console.log('显示右上角');\n                self.ranks.active = false\n                self.Balance.active = false\n                self.Friend.active = true\n                self.showFriendPass(data.data)\n            } else if (data.cmd === 4) { // 已通关好友, 中间\n                console.log('显示中间');\n                self.ranks.active = false\n                self.Balance.active = true\n                self.Friend.active = false\n                self.showBalancePass(data.data)\n            }\n        })\n    },\n\n    requestDataFromServer: function () {\n        var self = this;\n        Util.getWXFriendRanks().then(list => {\n            if (list) self.renderRank(list)\n        })\n    },\n\n    renderRank(players) {\n        let self = this;\n        let friends = players;\n        console.log('ranks = ', self.ranks)\n        let _content = self.ranks.getChildByName('view').getChildByName('content')\n        for (let i = 0; i < friends.length; i++) {\n            let item = cc.instantiate(self.RankItemPre);\n            _content.addChild(item);\n            item.getComponent(\"RankItemPrefab\").setPlayerInfo(i + 1, friends[i].avatarUrl, friends[i].nickname, friends[i].score, false);\n        }\n    },\n    isWxApp: function () {\n        return 'undefined' !== typeof (wx);\n    },\n\n\n    showFriendPass(data) {\n        this.Friend.active = true\n        console.log('Friend = ', this.Friend)\n        this.Friend.getComponent(FriendPassedView).updatePoint(data.pointId)\n\n    },\n    showBalancePass(info) {\n        this.Balance.active = true\n        console.log('Balance = ', this.Balance)\n        this.Balance.getComponent(BalancePassedView).updatePoint(info)\n    },\n});\n"]}
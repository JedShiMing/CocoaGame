{"version":3,"sources":["../../../../assets/Script/assets/Script/Util.js"],"names":["util","getWXFriendRanks","Promise","resolve","reject","wx","getFriendCloudStorage","keyList","success","players","i","res","data","length","obj","k","KVDataList","kvData","key","JSON","parse","value","player","score","startTime","endTime","openid","nickname","avatarUrl","push","sort","a","b","getWeChatUserInfo","getUserInfo","openIdList","user","fail","eor","module","exports"],"mappings":";;;;;;AAAA,IAAMA,OAAO;AACT;AACAC,oBAFS,8BAEU;AACf,eAAO,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC1CC,eAAGC,qBAAH,CAAyB;AACrBC,yBAAS,CAAC,OAAD,CADY;AAErBC,yBAAS,sBAAO;AACZ,wBAAIC,UAAU,EAAd;;AAEA,yBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIC,IAAIC,IAAJ,CAASC,MAA7B,EAAqCH,GAArC,EAA0C;AACtC,4BAAIE,OAAOD,IAAIC,IAAJ,CAASF,CAAT,CAAX;;AAEA,4BAAII,MAAM,IAAV;;AAEA,6BAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIH,KAAKI,UAAL,CAAgBH,MAApC,EAA4CE,GAA5C,EAAiD;AAC7C,gCAAIE,SAASL,KAAKI,UAAL,CAAgBD,CAAhB,CAAb;;AAEA,gCAAIE,OAAOC,GAAP,KAAe,OAAnB,EAA4B;AACxBJ,sCAAMK,KAAKC,KAAL,CAAWH,OAAOI,KAAlB,CAAN;AACA;AACH;;AAED,gCAAIP,GAAJ,EAAS;AACL;AACH;AACJ;;AAED,4BAAIA,GAAJ,EAAS;AACL,gCAAIQ,SAAS,EAAb;AACAA,mCAAOC,KAAP,GAAeT,IAAIS,KAAJ,IAAa,CAA5B;AACAD,mCAAOE,SAAP,GAAmBV,IAAIU,SAAJ,IAAiB,CAApC;AACAF,mCAAOG,OAAP,GAAiBX,IAAIW,OAAJ,IAAe,CAAhC;AACAH,mCAAOI,MAAP,GAAgBd,KAAKc,MAArB;AACAJ,mCAAOK,QAAP,GAAkBf,KAAKe,QAAvB;AACAL,mCAAOM,SAAP,GAAmBhB,KAAKgB,SAAxB;AACAnB,oCAAQoB,IAAR,CAAaP,MAAb;AACH;AACJ;AACDb,4BAAQqB,IAAR,CAAa,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AACzB,+BAAO,EAAED,EAAER,KAAF,GAAUS,EAAET,KAAd,CAAP;AACH,qBAFD;AAGA,wBAAId,QAAQI,MAAR,GAAiB,CAArB,EAAwB;AACpBV,gCAAQM,OAAR;AACH;AACJ;AAxCoB,aAAzB;AA0CH,SA3CM,CAAP;AA4CH,KA/CQ;;;AAiDT;AACAwB,qBAlDS,+BAkDW;AAChB,eAAO,IAAI/B,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC1CC,eAAG6B,WAAH,CAAe;AACXC,4BAAY,CAAC,YAAD,CADD;AAEX3B,yBAAS,iBAAC4B,IAAD,EAAU;AACfjC,4BAAQiC,KAAKxB,IAAb;AACH,iBAJU;AAKXyB,sBAAM,cAACC,GAAD,EAAS;AACXlC,2BAAOkC,GAAP;AACH;AAPU,aAAf;AASH,SAVM,CAAP;AAWH;AA9DQ,CAAb;;AAiEAC,OAAOC,OAAP,GAAiBxC,IAAjB","file":"Util.js","sourceRoot":"../../../../assets/Script","sourcesContent":["const util = {\n    // 获取微信好友排行榜数据\n    getWXFriendRanks() {\n        return new Promise(function (resolve, reject) {\n            wx.getFriendCloudStorage({\n                keyList: [\"score\"],\n                success: res => {\n                    let players = [];\n\n                    for (let i = 0; i < res.data.length; i++) {\n                        var data = res.data[i];\n\n                        var obj = null;\n\n                        for (let k = 0; k < data.KVDataList.length; k++) {\n                            var kvData = data.KVDataList[k];\n\n                            if (kvData.key === \"score\") {\n                                obj = JSON.parse(kvData.value);\n                                break;\n                            }\n\n                            if (obj) {\n                                break;\n                            }\n                        }\n\n                        if (obj) {\n                            var player = {};\n                            player.score = obj.score || 0;\n                            player.startTime = obj.startTime || 0;\n                            player.endTime = obj.endTime || 0;\n                            player.openid = data.openid;\n                            player.nickname = data.nickname;\n                            player.avatarUrl = data.avatarUrl;\n                            players.push(player);\n                        }\n                    }\n                    players.sort(function (a, b) {\n                        return -(a.score - b.score)\n                    });\n                    if (players.length > 0) {\n                        resolve(players)\n                    }\n                }\n            });\n        })\n    },\n\n    // 获取微信个人信息\n    getWeChatUserInfo() {\n        return new Promise(function (resolve, reject) {\n            wx.getUserInfo({\n                openIdList: ['selfOpenId'],\n                success: (user) => {\n                    resolve(user.data)\n                },\n                fail: (eor) => {\n                    reject(eor)\n                }\n            })\n        })\n    }\n};\n\nmodule.exports = util;\n"]}
{"version":3,"sources":["HallGiftDialog.js"],"names":["DialogBase","require","cc","Class","extends","properties","toggle_share","Toggle","label_gold","Label","asset_select","SpriteFrame","btn_select","Sprite","onLoad","select","prototype","call","onEnable","params","AF","DIALOG_PARAMS","string","GameData","getMyPlayerData","gold","toString","spriteFrame","onDisable","EventDispatcher","emit","pointId","costTime","onselect","onBtnClick","tag","Date","now","playerData","util","shareAppMessage","giftTag","savePlayerData","close","summary","setMyPlayerData"],"mappings":";;;;;;AAAA,IAAIA,aAAaC,QAAQ,cAAR,CAAjB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASJ,UADJ;;AAGLK,gBAAY;AACRC,sBAAcJ,GAAGK,MADT;AAERC,oBAAYN,GAAGO,KAFP;;AAIRC,sBAAc,CAACR,GAAGS,WAAJ,CAJN;AAKRC,oBAAYV,GAAGW;AALP,KAHP;AAUL;AACAC,YAAQ,kBAAY;AAChB,aAAKC,MAAL,GAAc,KAAd;AACAf,mBAAWgB,SAAX,CAAqBF,MAArB,CAA4BG,IAA5B,CAAiC,IAAjC;AACH,KAdI;;AAgBLC,cAAU,oBAAY;AAClBlB,mBAAWgB,SAAX,CAAqBE,QAArB,CAA8BD,IAA9B,CAAmC,IAAnC;AACA,aAAKE,MAAL,GAAcC,GAAGC,aAAH,EAAd;AACA,aAAKb,UAAL,CAAgBc,MAAhB,GAAyBF,GAAGG,QAAH,CAAYC,eAAZ,GAA8BC,IAA9B,CAAmCC,QAAnC,EAAzB;;AAEA,aAAKX,MAAL,GAAc,KAAd;AACA,aAAKH,UAAL,CAAgBe,WAAhB,GAA8B,KAAKjB,YAAL,CAAkB,CAAlB,CAA9B;AACH,KAvBI;;AAyBLkB,eAAW,qBAAY;AACnBR,WAAGS,eAAH,CAAmBC,IAAnB,CAAwB,mBAAxB,EAA6C,EAAEC,SAAS,KAAKZ,MAAL,CAAYY,OAAvB,EAAgCC,UAAU,KAAKb,MAAL,CAAYa,QAAtD,EAA7C;AACH,KA3BI;;AA6BLC,YA7BK,sBA6BM;AACP,aAAKlB,MAAL,GAAc,CAAC,KAAKA,MAApB;AACA,aAAKH,UAAL,CAAgBe,WAAhB,GAA8B,KAAKZ,MAAL,GAAc,KAAKL,YAAL,CAAkB,CAAlB,CAAd,GAAqC,KAAKA,YAAL,CAAkB,CAAlB,CAAnE;AACH,KAhCI;AAkCLwB,cAlCK,wBAkCQ;AAAA;;AACT,YAAMC,MAAMC,KAAKC,GAAL,GAAWX,QAAX,EAAZ;AACA,YAAIY,aAAalB,GAAGG,QAAH,CAAYC,eAAZ,EAAjB;AACA,YAAI,KAAKT,MAAT,EAAiB;AACbK,eAAGmB,IAAH,CAAQC,eAAR,CAAwB,IAAxB,EAA8B,YAAM;AAChCF,2BAAWG,OAAX,GAAqBN,GAArB;AACAG,2BAAWb,IAAX,IAAmB,GAAnB;AACAL,mBAAGG,QAAH,CAAYmB,cAAZ,CAA2BJ,UAA3B;AACA,sBAAKK,KAAL;AACH,aALD,EAKG,YAAM;AACLL,2BAAWG,OAAX,GAAqBN,GAArB;AACAG,2BAAWb,IAAX,IAAmB,GAAnB;AACAL,mBAAGG,QAAH,CAAYmB,cAAZ,CAA2BJ,UAA3B;AACA,sBAAKK,KAAL;AACH,aAVD,EAUG,EAAEF,SAASN,GAAX,EAVH,EAUqB,MAVrB,EAU6B,EAAES,SAAS,aAAX,EAV7B;AAWH,SAZD,MAYO;AACHN,uBAAWb,IAAX,IAAmB,GAAnB;AACAL,eAAGG,QAAH,CAAYsB,eAAZ,CAA4BP,UAA5B;AACAlB,eAAGG,QAAH,CAAYmB,cAAZ,CAA2BJ,UAA3B;AACAlB,eAAGS,eAAH,CAAmBC,IAAnB,CAAwB,aAAxB;AACA,iBAAKa,KAAL;AACH;AACJ;AAxDI,CAAT","file":"HallGiftDialog.js","sourceRoot":"../../../../../../assets/hall/ui/dialog","sourcesContent":["var DialogBase = require('AFDialogBase');\r\n\r\ncc.Class({\r\n    extends: DialogBase,\r\n\r\n    properties: {\r\n        toggle_share: cc.Toggle,\r\n        label_gold: cc.Label,\r\n\r\n        asset_select: [cc.SpriteFrame],\r\n        btn_select: cc.Sprite,\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad: function () {\r\n        this.select = false\r\n        DialogBase.prototype.onLoad.call(this);\r\n    },\r\n\r\n    onEnable: function () {\r\n        DialogBase.prototype.onEnable.call(this);\r\n        this.params = AF.DIALOG_PARAMS()\r\n        this.label_gold.string = AF.GameData.getMyPlayerData().gold.toString();\r\n\r\n        this.select = false;\r\n        this.btn_select.spriteFrame = this.asset_select[1]\r\n    },\r\n\r\n    onDisable: function () {\r\n        AF.EventDispatcher.emit('ShowBalancePassed', { pointId: this.params.pointId, costTime: this.params.costTime })\r\n    },\r\n\r\n    onselect() {\r\n        this.select = !this.select\r\n        this.btn_select.spriteFrame = this.select ? this.asset_select[0] : this.asset_select[1]\r\n    },\r\n\r\n    onBtnClick() {\r\n        const tag = Date.now().toString()\r\n        let playerData = AF.GameData.getMyPlayerData();\r\n        if (this.select) {\r\n            AF.util.shareAppMessage(null, () => {\r\n                playerData.giftTag = tag\r\n                playerData.gold += 600\r\n                AF.GameData.savePlayerData(playerData);\r\n                this.close()\r\n            }, () => {\r\n                playerData.giftTag = tag\r\n                playerData.gold += 600\r\n                AF.GameData.savePlayerData(playerData);\r\n                this.close()\r\n            }, { giftTag: tag }, 'gift', { summary: '灰太狼去哪了？点击翻倍' })\r\n        } else {\r\n            playerData.gold += 600\r\n            AF.GameData.setMyPlayerData(playerData);\r\n            AF.GameData.savePlayerData(playerData);\r\n            AF.EventDispatcher.emit('GoldRefresh');\r\n            this.close()\r\n        }\r\n    },\r\n\r\n});\r\n"]}
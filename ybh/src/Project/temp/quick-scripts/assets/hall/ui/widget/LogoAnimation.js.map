{"version":3,"sources":["LogoAnimation.js"],"names":["cc","Class","extends","Component","properties","cloudUp","Node","cloudDown","logoNode","goldNode","playerNode","playerFrames","default","type","SpriteFrame","onLoad","onEnable","goldAction","addMoveEffect","playKjrwAnimation","self","actions","i","push","callFunc","getComponent","Sprite","spriteFrame","delayTime","length","runAction","repeatForever","sequence","moveBy","addCloudEffect","node","dxAndDts","dx","random0To1","dt1","dt2","dt","index","Math","floor","random","actionInfo","splice","action","actionName","moveActionInfo","speed_min","speed_max","currSpeed","init_x","diff_x","target","getPositionX","x","currPosX","currdiffX","direction","ceil","winSize","width","currWorldPos","convertToWorldSpaceAR","v2","scale","schedule"],"mappings":"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","file":"LogoAnimation.js","sourceRoot":"../../../../../../assets/hall/ui/widget","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        cloudUp:cc.Node,\r\n        cloudDown:cc.Node,\r\n        logoNode:cc.Node,\r\n        goldNode:cc.Node,\r\n        playerNode:cc.Node,\r\n\r\n        playerFrames: {\r\n            default: [],\r\n            type: cc.SpriteFrame\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad: function () {\r\n        // playerNode;\r\n        // var kjrwEffect = cc.instantiate(this.effectPre);\r\n        // this.playerNode.addChild(kjrwEffect, 1, 'kjrwEffect');\r\n        // var kjrwEffectScript = kjrwEffect.getComponent('EffectPrefab');\r\n        // kjrwEffectScript.doStart('kjrw', 1, Infinity);\r\n    },\r\n\r\n    onEnable: function () {\r\n        this.goldAction();\r\n        // this.cloudDown.active = false;\r\n        // this.cloudUp.active = false;\r\n        this.addMoveEffect(this.cloudDown);\r\n        this.addMoveEffect(this.cloudUp);\r\n        this.playKjrwAnimation();\r\n    },\r\n    \r\n    playKjrwAnimation:function(){\r\n        var self = this;\r\n        var actions = [];\r\n        for (let i = 0; i < this.playerFrames.length; i++) {\r\n            // playerNode\r\n            actions.push(cc.callFunc(function () {\r\n                self.playerNode.getComponent(cc.Sprite).spriteFrame =  self.playerFrames[i];\r\n            }));\r\n            actions.push(cc.delayTime(1 / 60 * 7 + i * 1 / 60 * 7));\r\n        }\r\n        this.playerNode.runAction(cc.repeatForever(cc.sequence(actions)));\r\n\r\n    },\r\n\r\n    goldAction: function () {\r\n        var actions = [];\r\n        actions.push(cc.moveBy(0.5, 0, 16));\r\n        actions.push(cc.moveBy(1.0, 0, -32));\r\n        actions.push(cc.moveBy(0.5, 0, 16));\r\n        this.goldNode.runAction(cc.repeatForever(cc.sequence(actions)));\r\n    },\r\n\r\n    addCloudEffect: function (node) {\r\n        var dxAndDts = [];\r\n        for (let i = 1; i <= 4; i++) {\r\n            let dx = i * 10 + cc.random0To1() * 20;\r\n            let dt1 = i * 1 + cc.random0To1() * 1;\r\n            let dt2 = i * 1 + cc.random0To1() * 1;\r\n            dxAndDts.push({ dx: dx, dt: dt1 });\r\n            dxAndDts.push({ dx: 0 - dx, dt: dt2 });\r\n        }\r\n        var actions = [];\r\n        while (true) {\r\n            if (!dxAndDts.length) { break; }\r\n            var index = Math.floor(Math.random() * dxAndDts.length);\r\n            var actionInfo = dxAndDts.splice(index, 1);\r\n            actions.push(cc.moveBy(actionInfo[0].dt, actionInfo[0].dx, 0));\r\n        }\r\n        var action = cc.repeatForever(cc.sequence(actions));\r\n        node.runAction(action);\r\n    },\r\n\r\n    addMoveEffect: function (node) {\r\n        if (node === null) {\r\n            return;\r\n        }\r\n        let actionName = 'MoveActionName';\r\n\r\n        let moveActionInfo = {}\r\n        moveActionInfo.speed_min = 10\r\n        moveActionInfo.speed_max = 30\r\n        moveActionInfo.currSpeed = 0\r\n        moveActionInfo.init_x = 0\r\n        moveActionInfo.diff_x = 0\r\n\r\n        moveActionInfo.target = node\r\n        moveActionInfo.init_x = node.getPositionX()\r\n\r\n        moveActionInfo.target[actionName] = function (dt) {\r\n            node.x += moveActionInfo.currSpeed * dt\r\n            let currPosX = node.getPositionX()\r\n            let currdiffX = currPosX - moveActionInfo.init_x\r\n            let direction = (Math.ceil(Math.random() * 1000) % 2) ? -1 : 1\r\n            if ((moveActionInfo.currSpeed <= 0 && currdiffX <= moveActionInfo.diff_x)\r\n                || (moveActionInfo.currSpeed >= 0 && currdiffX >= moveActionInfo.diff_x)) {\r\n                moveActionInfo.diff_x = direction * cc.winSize.width * 0.5 * Math.random()\r\n                moveActionInfo.currSpeed = direction * (moveActionInfo.speed_min + Math.random() * (moveActionInfo.speed_max - moveActionInfo.speed_min))\r\n                return;\r\n            }\r\n            let currWorldPos = node.convertToWorldSpaceAR(cc.v2(0, 0))\r\n            if ((currWorldPos.x + node.width / 2 * node.scale) >= 640) {\r\n                direction = -1\r\n                moveActionInfo.diff_x = direction * cc.winSize.width * 0.5 * Math.random()\r\n                moveActionInfo.currSpeed = direction * (moveActionInfo.speed_min + Math.random() * (moveActionInfo.speed_max - moveActionInfo.speed_min))\r\n                return;\r\n            }\r\n            if ((currWorldPos.x - node.width / 2 * node.scale) <= 0) {\r\n                direction = 1\r\n                moveActionInfo.diff_x = direction * cc.winSize.width * 0.5 * Math.random()\r\n                moveActionInfo.currSpeed = direction * (moveActionInfo.speed_min + Math.random() * (moveActionInfo.speed_max - moveActionInfo.speed_min))\r\n                return;\r\n            }\r\n        };\r\n        this.schedule(moveActionInfo.target[actionName], 0);\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}
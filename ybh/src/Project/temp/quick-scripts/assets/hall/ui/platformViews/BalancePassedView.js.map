{"version":3,"sources":["BalancePassedView.js"],"names":["itemWidth","cc","Class","extends","Component","properties","qqCon","Node","heads","label_time","Label","wxDisplay","Sprite","onLoad","AF","EventDispatcher","on","updatePoint","active","onDestroy","off","pointId","costTime","platform","isWxApp","util","postMessage","isQQApp","getRankList","ranklist","selfId","i","length","selfFlag","list","updateHeads","getComponent","setPhoto","url","string","score"],"mappings":";;;;;;AAAA,IAAMA,YAAY,EAAlB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,eAAOL,GAAGM,IADF;AAERC,eAAO,CAACP,GAAGM,IAAJ,CAFC;AAGRE,oBAAY,CAACR,GAAGS,KAAJ,CAHJ;AAIRC,mBAAWV,GAAGW;AAJN,KAHP;;AAUL;AACAC,YAAQ,kBAAY;AAChBC,WAAGC,eAAH,CAAmBC,EAAnB,CAAsB,qBAAtB,EAA6C,KAAKC,WAAlD,EAA+D,IAA/D;;AAEA,aAAKX,KAAL,CAAWY,MAAX,GAAoB,KAApB;AACH,KAfI;AAgBLC,aAhBK,uBAgBO;AACRL,WAAGC,eAAH,CAAmBK,GAAnB,CAAuB,qBAAvB,EAA8C,KAAKH,WAAnD,EAAgE,IAAhE;AACH,KAlBI;;AAmBLA,iBAAa,2BAAiC;AAAA;;AAAA,YAArBI,OAAqB,QAArBA,OAAqB;AAAA,YAAZC,QAAY,QAAZA,QAAY;;AAC1C,aAAKD,OAAL,GAAeA,OAAf;AACA,aAAKC,QAAL,GAAgBA,QAAhB;AACA,YAAIR,GAAGS,QAAH,CAAYC,OAAZ,EAAJ,EAA2B;AACvBV,eAAGW,IAAH,CAAQC,WAAR,CAAoB,CAApB,EAAuB,EAAEL,gBAAF,EAAWC,kBAAX,EAAvB;AACH,SAFD,MAGK,IAAIR,GAAGS,QAAH,CAAYI,OAAZ,EAAJ,EAA2B;AAC5B,iBAAKrB,KAAL,CAAWY,MAAX,GAAoB,IAApB;AACAJ,eAAGW,IAAH,CAAQG,WAAR,CAAoB,oBAAY;AAC5B,oBAAIC,QAAJ,EAAc;AACV,wBAAIC,SAAS,CAAb;AACA,yBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,SAASG,MAA7B,EAAqCD,GAArC,EAA0C;AACtC,4BAAGF,SAASE,CAAT,EAAYE,QAAZ,KAAyB,CAA5B,EAA+B;AAC3BH,qCAASC,CAAT;AACA;AACH;AACJ;AACD,0BAAKG,IAAL,GAAY,EAAZ;AACA,wBAAIJ,WAAW,CAAf,EAAkB;AACd,8BAAKI,IAAL,GAAY,CAACL,SAASC,MAAT,CAAD,EAAkBD,SAASC,SAAS,CAAlB,CAAlB,EAAuCD,SAASC,SAAS,CAAlB,CAAvC,CAAZ;AACH,qBAFD,MAEO,IAAIA,WAAWD,SAASG,MAAT,GAAkB,CAAjC,EAAoC;AACvC,8BAAKE,IAAL,GAAY,CAACL,SAASC,SAAS,CAAlB,CAAD,EAAsBD,SAASC,SAAS,CAAlB,CAAtB,EAA2CD,SAASC,MAAT,CAA3C,CAAZ;AACH,qBAFM,MAEA;AACH,8BAAKI,IAAL,GAAY,CAACL,SAASC,SAAS,CAAlB,CAAD,EAAsBD,SAASC,MAAT,CAAtB,EAAuCD,SAASC,SAAS,CAAlB,CAAvC,CAAZ;AACH;AACD,0BAAKK,WAAL;AACH;AACJ,aAnBD;AAoBH;AACJ,KAhDI;;AAkDLA,iBAAa,uBAAY;AACrB,aAAK,IAAIJ,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AACxB,iBAAKvB,KAAL,CAAWuB,CAAX,EAAcb,MAAd,GAAuB,IAAvB;AACA,iBAAKV,KAAL,CAAWuB,CAAX,EAAcK,YAAd,CAA2B,aAA3B,EAA0CC,QAA1C,CAAmD,KAAKH,IAAL,CAAUH,CAAV,EAAaO,GAAhE;AACA,iBAAK7B,UAAL,CAAgBsB,CAAhB,EAAmBQ,MAAnB,GAA4B,KAAKL,IAAL,CAAUH,CAAV,EAAaS,KAAb,GAAqB,GAAjD;AACH;AACJ;AAxDI,CAAT","file":"BalancePassedView.js","sourceRoot":"../../../../../../assets/hall/ui/platformViews","sourcesContent":["const itemWidth = 90\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        qqCon: cc.Node,\r\n        heads: [cc.Node],\r\n        label_time: [cc.Label],\r\n        wxDisplay: cc.Sprite,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad: function () {\r\n        AF.EventDispatcher.on('UpdateBalancePassed', this.updatePoint, this)\r\n\r\n        this.qqCon.active = false\r\n    },\r\n    onDestroy() {\r\n        AF.EventDispatcher.off('UpdateBalancePassed', this.updatePoint, this)\r\n    },\r\n    updatePoint: function ({ pointId, costTime }) {\r\n        this.pointId = pointId\r\n        this.costTime = costTime\r\n        if (AF.platform.isWxApp()) {\r\n            AF.util.postMessage(4, { pointId, costTime });\r\n        }\r\n        else if (AF.platform.isQQApp()) {\r\n            this.qqCon.active = true\r\n            AF.util.getRankList(ranklist => {\r\n                if (ranklist) {\r\n                    let selfId = 0\r\n                    for (let i = 0; i < ranklist.length; i++) {\r\n                        if(ranklist[i].selfFlag === 1) {\r\n                            selfId = i;\r\n                            break;\r\n                        }\r\n                    }\r\n                    this.list = []\r\n                    if (selfId === 0) {\r\n                        this.list = [ranklist[selfId],ranklist[selfId + 1],ranklist[selfId + 2]]\r\n                    } else if (selfId === ranklist.length - 1) {\r\n                        this.list = [ranklist[selfId - 2],ranklist[selfId - 1],ranklist[selfId]]\r\n                    } else {\r\n                        this.list = [ranklist[selfId - 1],ranklist[selfId],ranklist[selfId + 1]]\r\n                    }\r\n                    this.updateHeads()\r\n                }\r\n            })\r\n        }\r\n    },\r\n\r\n    updateHeads: function () {\r\n        for (let i = 0; i < 3; i++) {\r\n            this.heads[i].active = true\r\n            this.heads[i].getComponent(\"PhotoPrefab\").setPhoto(this.list[i].url);\r\n            this.label_time[i].string = this.list[i].score + 'å…³';\r\n        }\r\n    }\r\n})\r\n\r\n\r\n\r\n"]}
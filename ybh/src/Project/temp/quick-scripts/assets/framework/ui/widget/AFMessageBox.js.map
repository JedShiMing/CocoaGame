{"version":3,"sources":["AFMessageBox.js"],"names":["DialogBase","require","TypeYesNo","cc","Enum","LEFT_YES_RIGHT_NO","RIGHT_YES_LEFT_NO","Class","extends","editor","menu","properties","txTitle","type","Label","default","displayName","txContent","richTxContent","RichText","btnClose","Button","btnLeft","btnRight","btnMiddle","typeYesNo","tooltip","onLoad","prototype","call","onEnable","option","AF","DIALOG_PARAMS","_option","validate","node","active","enableCloseButton","string","title","content","richText","enableTouchEmptyPlaceToClose","zOrder","runAction","sequence","delayTime","callFunc","zIndex","undefined","MessageBox","TYPE_YES_NO","yesButtonText","noButtonText","_setYesNoBtnText","TYPE_OK","okButtonText","lb","getComponentInChildren","onDisable","onDestroy","CC_EDITOR","error","left","right","leftYes","close","code","doCallback","RET_CLOSE","callback","onBtnCloseClicked","onBtnMiddle","RET_OK","onBtnLeft","RET_YES","RET_NO","onBtnRight"],"mappings":";;;;;;AAAA,IAAIA,aAAaC,QAAQ,cAAR,CAAjB;;AAEA,IAAIC,YAAYC,GAAGC,IAAH,CAAQ;AACpBC,uBAAmB,CAAC,CADA;AAEpBC,uBAAmB,CAAC;AAFA,CAAR,CAAhB;;AAKAH,GAAGI,KAAH,CAAS;AACLC,aAASR,UADJ;;AAGLS,YAAQ;AACJC,cAAM;AADF,KAHH;;AAOLC,gBAAY;AACRC,iBAAS;AACLC,kBAAMV,GAAGW,KADJ;AAELC,qBAAS,IAFJ;AAGLC,yBAAa;AAHR,SADD;AAMRC,mBAAW;AACPJ,kBAAMV,GAAGW,KADF;AAEPC,qBAAS,IAFF;AAGPC,yBAAa;AAHN,SANH;AAWRE,uBAAe;AACXL,kBAAMV,GAAGgB,QADE;AAEXJ,qBAAS,IAFE;AAGXC,yBAAa;AAHF,SAXP;AAgBRI,kBAAU;AACNP,kBAAMV,GAAGkB,MADH;AAENN,qBAAS,IAFH;AAGNC,yBAAa;AAHP,SAhBF;AAqBRM,iBAAS;AACLT,kBAAMV,GAAGkB,MADJ;AAELN,qBAAS,IAFJ;AAGLC,yBAAa;AAHR,SArBD;AA0BRO,kBAAU;AACNV,kBAAMV,GAAGkB,MADH;AAENN,qBAAS,IAFH;AAGNC,yBAAa;AAHP,SA1BF;AA+BRQ,mBAAW;AACPX,kBAAMV,GAAGkB,MADF;AAEPN,qBAAS,IAFF;AAGPC,yBAAa;AAHN,SA/BH;AAoCRS,mBAAW;AACPZ,kBAAMX,SADC;AAEPa,qBAASb,UAAUG,iBAFZ;AAGPW,yBAAa,aAHN;AAIPU,qBAAS;AAJF;AApCH,KAPP;;AAmDL;AACAC,YAAQ,kBAAY;AAChB3B,mBAAW4B,SAAX,CAAqBD,MAArB,CAA4BE,IAA5B,CAAiC,IAAjC;AACH,KAtDI;;AAwDLC,cAAU,oBAAY;AAClB9B,mBAAW4B,SAAX,CAAqBE,QAArB,CAA8BD,IAA9B,CAAmC,IAAnC;;AAEA,YAAIE,SAASC,GAAGC,aAAH,EAAb;AACA,aAAKC,OAAL,GAAeH,MAAf;;AAEA,YAAI,CAAC,KAAKI,QAAL,EAAL,EAAsB;;AAEtB,aAAKf,QAAL,CAAcgB,IAAd,CAAmBC,MAAnB,GAA4B,CAAC,CAACN,OAAOO,iBAArC,CARkB,CAQsC;AACxD,aAAK1B,OAAL,CAAa2B,MAAb,GAAsBR,OAAOS,KAAP,IAAgB,EAAtC;AACA,aAAKvB,SAAL,CAAesB,MAAf,GAAwBR,OAAOU,OAAP,IAAkB,EAA1C;AACA,aAAKvB,aAAL,CAAmBqB,MAAnB,GAA4BR,OAAOW,QAAP,IAAmB,EAA/C;AACA,aAAKC,4BAAL,GAAoCZ,OAAOY,4BAA3C;AACA,aAAKC,MAAL,GAAcb,OAAOa,MAArB;;AAEA,aAAKR,IAAL,CAAUS,SAAV,CAAoB1C,GAAG2C,QAAH,CAChB3C,GAAG4C,SAAH,CAAa,GAAb,CADgB,EAEhB5C,GAAG6C,QAAH,CAAY,YAAY;AACpB,gBAAI,KAAKJ,MAAT,EAAiB;AACb,qBAAKR,IAAL,CAAUa,MAAV,GAAmB,KAAKL,MAAxB;AACA,qBAAKA,MAAL,GAAcM,SAAd;AACH;AACJ,SALD,EAKG,IALH,CAFgB,CAApB;AASA;AACA,YAAInB,OAAOlB,IAAP,IAAemB,GAAGmB,UAAH,CAAcC,WAAjC,EAA8C;AAC1C,iBAAK9B,OAAL,CAAac,IAAb,CAAkBC,MAAlB,GAA2B,KAAKd,QAAL,CAAca,IAAd,CAAmBC,MAAnB,GAA4B,IAAvD;AACA,iBAAKb,SAAL,CAAeY,IAAf,CAAoBC,MAApB,GAA6B,KAA7B;AACA,gBAAIN,OAAOsB,aAAP,IAAwBtB,OAAOuB,YAA/B,IAA+C,KAAK7B,SAAL,IAAkBvB,UAAUG,iBAA/E,EAAkG;AAC9F,qBAAKkD,gBAAL,CAAsBxB,MAAtB;AACH;AAEJ,SAPD,MAOO,IAAIA,OAAOlB,IAAP,IAAemB,GAAGmB,UAAH,CAAcK,OAAjC,EAA0C;AAC7C,iBAAKlC,OAAL,CAAac,IAAb,CAAkBC,MAAlB,GAA2B,KAAKd,QAAL,CAAca,IAAd,CAAmBC,MAAnB,GAA4B,KAAvD;AACA,iBAAKb,SAAL,CAAeY,IAAf,CAAoBC,MAApB,GAA6B,IAA7B;AACA,gBAAIN,OAAO0B,YAAX,EAAyB;AACrB,oBAAIC,KAAK,KAAKlC,SAAL,CAAemC,sBAAf,CAAsCxD,GAAGW,KAAzC,CAAT;AACA,oBAAI4C,EAAJ,EAAQ;AACJA,uBAAGnB,MAAH,GAAYR,OAAO0B,YAAnB;AACH;AACJ;AACJ;AACD;AACH,KAnGI;;AAqGLG,eAAW,qBAAY;AACnB5D,mBAAW4B,SAAX,CAAqBgC,SAArB,CAA+B/B,IAA/B,CAAoC,IAApC;AACH,KAvGI;;AAyGLgC,eAAW,qBAAY;AACnB7D,mBAAW4B,SAAX,CAAqBiC,SAArB,CAA+BhC,IAA/B,CAAoC,IAApC;AACH,KA3GI;;AA6GLM,cAAU,oBAAY;AAClB,YAAI,CAAC,KAAKD,OAAV,EAAmB,OAAO,KAAP;AACnB,YAAI,CAAC,KAAKjB,SAAN,IAAmB,CAAC,KAAKC,aAAzB,IAA0C,CAAC,KAAKN,OAAhD,IAA2D,CAAC,KAAKQ,QAAjE,IACG,CAAC,KAAKE,OADT,IACoB,CAAC,KAAKC,QAD1B,IACsC,CAAC,KAAKC,SADhD,EAC2D;AACvD,aAACsC,SAAD,IAAc3D,GAAG4D,KAAH,CAAS,4CAAT,CAAd;AACA,mBAAO,KAAP;AACH;AACD,eAAO,IAAP;AACH,KArHI;;AAuHLR,sBAAkB,0BAAUxB,MAAV,EAAkB;AAChC,YAAIiC,OAAO,KAAK1C,OAAL,CAAaqC,sBAAb,CAAoCxD,GAAGW,KAAvC,CAAX;AACA,YAAImD,QAAQ,KAAK1C,QAAL,CAAcoC,sBAAd,CAAqCxD,GAAGW,KAAxC,CAAZ;AACA,YAAI,CAACkD,IAAD,IAAS,CAACC,KAAd,EAAqB;;AAErB,YAAIC,UAAU,KAAKzC,SAAL,IAAkBvB,UAAUG,iBAA1C;;AAEA,YAAI,CAAC6D,OAAL,EAAc;AACVF,iBAAKzB,MAAL,GAAc,IAAd;AACA0B,kBAAM1B,MAAN,GAAe,IAAf;AACH;;AAED,YAAIR,OAAOsB,aAAX,EAA0B;AACtBa,sBAAUF,KAAKzB,MAAL,GAAcR,OAAOsB,aAA/B,GAA+CY,MAAM1B,MAAN,GAAeR,OAAOsB,aAArE;AACH;AACD,YAAItB,OAAOuB,YAAX,EAAyB;AACrBY,sBAAUD,MAAM1B,MAAN,GAAeR,OAAOuB,YAAhC,GAA+CU,KAAKzB,MAAL,GAAcR,OAAOuB,YAApE;AACH;AACJ,KAzII;;AA2ILa,WAAO,eAAUC,IAAV,EAAgB;AACnBpE,mBAAW4B,SAAX,CAAqBuC,KAArB,CAA2BtC,IAA3B,CAAgC,IAAhC;AACA,aAAKwC,UAAL,CAAgBD,QAAQpC,GAAGmB,UAAH,CAAcmB,SAAtC;AACA,aAAKpC,OAAL,GAAegB,SAAf;AACH,KA/II;;AAiJLmB,gBAAY,oBAAUD,IAAV,EAAgB;AACxB,YAAI,KAAKlC,OAAL,IAAgB,KAAKA,OAAL,CAAaqC,QAAjC,EAA2C;AACvC,iBAAKrC,OAAL,CAAaqC,QAAb,CAAsBH,IAAtB;AACH;AACJ,KArJI;;AAuJLI,uBAAmB,6BAAY;AAC3B,aAAKL,KAAL;AACH,KAzJI;;AA2JLM,iBAAa,uBAAY;AACrB,aAAKN,KAAL,CAAWnC,GAAGmB,UAAH,CAAcuB,MAAzB;AACH,KA7JI;;AA+JLC,eAAW,qBAAY;AACnB,YAAIP,OAAO,KAAK3C,SAAL,IAAkBvB,UAAUG,iBAA5B,GACL2B,GAAGmB,UAAH,CAAcyB,OADT,GACmB5C,GAAGmB,UAAH,CAAc0B,MAD5C;AAEA,aAAKV,KAAL,CAAWC,IAAX;AACH,KAnKI;;AAqKLU,gBAAY,sBAAY;AACpB,YAAIV,OAAO,KAAK3C,SAAL,IAAkBvB,UAAUG,iBAA5B,GACL2B,GAAGmB,UAAH,CAAc0B,MADT,GACkB7C,GAAGmB,UAAH,CAAcyB,OAD3C;AAEA,aAAKT,KAAL,CAAWC,IAAX;AACH;AAzKI,CAAT","file":"AFMessageBox.js","sourceRoot":"../../../../../../assets/framework/ui/widget","sourcesContent":["var DialogBase = require('AFDialogBase');\r\n\r\nvar TypeYesNo = cc.Enum({\r\n    LEFT_YES_RIGHT_NO: -1,\r\n    RIGHT_YES_LEFT_NO: -1,\r\n});\r\n\r\ncc.Class({\r\n    extends: DialogBase,\r\n\r\n    editor: {\r\n        menu: 'ApplicationFramework/AFMessageBox'\r\n    },\r\n\r\n    properties: {\r\n        txTitle: {\r\n            type: cc.Label,\r\n            default: null,\r\n            displayName: '标题',\r\n        },\r\n        txContent: {\r\n            type: cc.Label,\r\n            default: null,\r\n            displayName: '内容',\r\n        },\r\n        richTxContent: {\r\n            type: cc.RichText,\r\n            default: null,\r\n            displayName: '富文本',\r\n        },\r\n        btnClose: {\r\n            type: cc.Button,\r\n            default: null,\r\n            displayName: '关闭按钮',\r\n        },\r\n        btnLeft: {\r\n            type: cc.Button,\r\n            default: null,\r\n            displayName: '左边按钮',\r\n        },\r\n        btnRight: {\r\n            type: cc.Button,\r\n            default: null,\r\n            displayName: '右边按钮',\r\n        },\r\n        btnMiddle: {\r\n            type: cc.Button,\r\n            default: null,\r\n            displayName: '中间按钮',\r\n        },\r\n        typeYesNo: {\r\n            type: TypeYesNo,\r\n            default: TypeYesNo.LEFT_YES_RIGHT_NO,\r\n            displayName: 'YesNo按钮排列方式',\r\n            tooltip: '左边Yes右边No，或者左边No右边Yes'\r\n        },\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        DialogBase.prototype.onLoad.call(this);\r\n    },\r\n\r\n    onEnable: function () {\r\n        DialogBase.prototype.onEnable.call(this);\r\n\r\n        var option = AF.DIALOG_PARAMS();\r\n        this._option = option;\r\n\r\n        if (!this.validate()) return;\r\n\r\n        this.btnClose.node.active = !!option.enableCloseButton; // 关闭按钮是否设置\r\n        this.txTitle.string = option.title || '';\r\n        this.txContent.string = option.content || '';\r\n        this.richTxContent.string = option.richText || '';\r\n        this.enableTouchEmptyPlaceToClose = option.enableTouchEmptyPlaceToClose;\r\n        this.zOrder = option.zOrder;\r\n\r\n        this.node.runAction(cc.sequence(\r\n            cc.delayTime(0.5),\r\n            cc.callFunc(function () {\r\n                if (this.zOrder) {\r\n                    this.node.zIndex = this.zOrder;\r\n                    this.zOrder = undefined;\r\n                }\r\n            }, this),\r\n        ));\r\n        // 设置按钮及按钮文本\r\n        if (option.type == AF.MessageBox.TYPE_YES_NO) {\r\n            this.btnLeft.node.active = this.btnRight.node.active = true;\r\n            this.btnMiddle.node.active = false;\r\n            if (option.yesButtonText || option.noButtonText || this.typeYesNo != TypeYesNo.LEFT_YES_RIGHT_NO) {\r\n                this._setYesNoBtnText(option);\r\n            }\r\n\r\n        } else if (option.type == AF.MessageBox.TYPE_OK) {\r\n            this.btnLeft.node.active = this.btnRight.node.active = false;\r\n            this.btnMiddle.node.active = true;\r\n            if (option.okButtonText) {\r\n                var lb = this.btnMiddle.getComponentInChildren(cc.Label);\r\n                if (lb) {\r\n                    lb.string = option.okButtonText;\r\n                }\r\n            }\r\n        }\r\n        // this.node.zIndex = AF.Const.MESSAGE_BOX_Z_ORDER;\r\n    },\r\n\r\n    onDisable: function () {\r\n        DialogBase.prototype.onDisable.call(this);\r\n    },\r\n\r\n    onDestroy: function () {\r\n        DialogBase.prototype.onDestroy.call(this);\r\n    },\r\n\r\n    validate: function () {\r\n        if (!this._option) return false;\r\n        if (!this.txContent || !this.richTxContent || !this.txTitle || !this.btnClose\r\n            || !this.btnLeft || !this.btnRight || !this.btnMiddle) {\r\n            !CC_EDITOR && cc.error('invalid proterties, some component no set.');\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    _setYesNoBtnText: function (option) {\r\n        var left = this.btnLeft.getComponentInChildren(cc.Label);\r\n        var right = this.btnRight.getComponentInChildren(cc.Label);\r\n        if (!left || !right) return;\r\n\r\n        var leftYes = this.typeYesNo == TypeYesNo.LEFT_YES_RIGHT_NO;\r\n\r\n        if (!leftYes) {\r\n            left.string = '取消';\r\n            right.string = '确定';\r\n        }\r\n\r\n        if (option.yesButtonText) {\r\n            leftYes ? left.string = option.yesButtonText : right.string = option.yesButtonText;\r\n        }\r\n        if (option.noButtonText) {\r\n            leftYes ? right.string = option.noButtonText : left.string = option.noButtonText;\r\n        }\r\n    },\r\n\r\n    close: function (code) {\r\n        DialogBase.prototype.close.call(this);\r\n        this.doCallback(code || AF.MessageBox.RET_CLOSE);\r\n        this._option = undefined;\r\n    },\r\n\r\n    doCallback: function (code) {\r\n        if (this._option && this._option.callback) {\r\n            this._option.callback(code);\r\n        }\r\n    },\r\n\r\n    onBtnCloseClicked: function () {\r\n        this.close();\r\n    },\r\n\r\n    onBtnMiddle: function () {\r\n        this.close(AF.MessageBox.RET_OK);\r\n    },\r\n\r\n    onBtnLeft: function () {\r\n        var code = this.typeYesNo == TypeYesNo.LEFT_YES_RIGHT_NO\r\n            ? AF.MessageBox.RET_YES : AF.MessageBox.RET_NO;\r\n        this.close(code);\r\n    },\r\n\r\n    onBtnRight: function () {\r\n        var code = this.typeYesNo == TypeYesNo.LEFT_YES_RIGHT_NO\r\n            ? AF.MessageBox.RET_NO : AF.MessageBox.RET_YES;\r\n        this.close(code);\r\n    },\r\n});\r\n"]}
{"version":3,"sources":["af-asset-loader.js"],"names":["EventDispatcher","require","Event","Const","AssetLoader","init","_task","once","GAME_LOADED","_onGameLoaded","_startLoadDialogAssets","moduleName","info","AF","Config","getDialogList","cc","error","urls","list","module","len","length","i","push","dialogs","loader","loadResArray","exports"],"mappings":";;;;;;AAAA;;;;AAIA,IAAIA,kBAAkBC,QAAQ,qBAAR,CAAtB;AACA,IAAIC,QAAkBD,QAAQ,UAAR,CAAtB;AACA,IAAIE,QAAkBF,QAAQ,UAAR,CAAtB;;AAEA,IAAIG,cAAc;;AAEdC,UAAM,gBAAY;AACd,aAAKC,KAAL,GAAa,EAAb;;AAEA;AACAN,wBAAgBO,IAAhB,CAAqBL,MAAMM,WAA3B,EAAwC,KAAKC,aAA7C,EAA4D,IAA5D;AACH,KAPa;;AASdA,mBAAe,yBAAY;;AAEvB,aAAKC,sBAAL,CAA4B,WAA5B;AACA,aAAKA,sBAAL,CAA4B,MAA5B;AACH,KAba;;AAedA,4BAAwB,gCAASC,UAAT,EAAqB;AACzC,YAAIC,OAAOC,GAAGC,MAAH,CAAUC,aAAV,EAAX;AACA,YAAI,CAACH,IAAL,EAAW;AACPI,eAAGC,KAAH,CAAS,mDAAT;AACA;AACH;AACD,YAAIC,OAAO,EAAX;AACA,YAAIC,OAAOP,KAAKQ,MAAL,CAAYT,UAAZ,CAAX;AACA,YAAIU,MAAMF,KAAKG,MAAf;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,GAApB,EAAyB,EAAEE,CAA3B,EAA8B;AAC1BL,iBAAKM,IAAL,CAAUZ,KAAKa,OAAL,CAAaN,KAAKI,CAAL,CAAb,CAAV;AACH;;AAED,YAAIL,KAAKI,MAAL,IAAe,CAAnB,EAAsB;;AAEtBN,WAAGU,MAAH,CAAUC,YAAV,CAAuBT,IAAvB;AACH;;AA/Ba,CAAlB;;AAmCAd,YAAYC,IAAZ;;AAEAe,OAAOQ,OAAP,GAAiBxB,WAAjB","file":"af-asset-loader.js","sourceRoot":"../../../../../assets/framework/misc","sourcesContent":["/**\r\n * 后台静默下载资源\r\n */\r\n\r\nvar EventDispatcher = require(\"af-event-dispatcher\");\r\nvar Event           = require(\"af-event\");\r\nvar Const           = require(\"af-const\");\r\n\r\nvar AssetLoader = {\r\n\r\n    init: function () {\r\n        this._task = [];\r\n\r\n        // 监听各种消息\r\n        EventDispatcher.once(Event.GAME_LOADED, this._onGameLoaded, this);\r\n    },\r\n\r\n    _onGameLoaded: function () {\r\n\r\n        this._startLoadDialogAssets('framework');\r\n        this._startLoadDialogAssets('hall');\r\n    },\r\n\r\n    _startLoadDialogAssets: function(moduleName) {\r\n        var info = AF.Config.getDialogList();\r\n        if (!info) {\r\n            cc.error(\"load dialog assets failed, not found dialog list.\");\r\n            return;\r\n        }\r\n        var urls = [];\r\n        var list = info.module[moduleName];\r\n        var len = list.length;\r\n        for (var i = 0; i < len; ++i) {\r\n            urls.push(info.dialogs[list[i]]);\r\n        }\r\n\r\n        if (urls.length == 0) return;\r\n\r\n        cc.loader.loadResArray(urls);\r\n    },\r\n\r\n};\r\n\r\nAssetLoader.init();\r\n\r\nmodule.exports = AssetLoader;"]}
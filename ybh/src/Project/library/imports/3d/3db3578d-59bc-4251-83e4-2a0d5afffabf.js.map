{"version":3,"sources":["../../../../../../assets/hall/ui/widget/assets/hall/ui/widget/ProgressBasePrefab.js"],"names":["cc","Class","extends","Component","properties","goldNode","default","type","Node","displayName","goldNum","Label","crystalNode","crystalNum","expNum","levelUp","expProgress","ProgressBar","onLoad","init","index","step","listInfo","expNode","node","scale","active","intervalTime","durationTime","setExpProgressY","posY","y","showGain","gainInfo","string","expAdd","pos","goldAdd","crystalAdd","self","runAction","sequence","delayTime","callFunc","showExp","showAction","callBack","act","target","spawn","scaleTo","easing","easeBackOut","update","dt","length","percent","parent","getComponent","playLevelupAni","progress"],"mappings":"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","file":"ProgressBasePrefab.js","sourceRoot":"../../../../../../assets/hall/ui/widget","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        goldNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n            displayName: \"金币节点\"\r\n        },\r\n\r\n        goldNum: {\r\n            default: null,\r\n            type: cc.Label,\r\n            displayName: \"金币数目\"\r\n        },\r\n\r\n        crystalNode: {\r\n            default: null,\r\n            type: cc.Node,\r\n            displayName: \"水晶节点\"\r\n        },\r\n\r\n        crystalNum: {\r\n            default: null,\r\n            type: cc.Label,\r\n            displayName: \"水晶数目\"\r\n        },\r\n\r\n        expNum: {\r\n            default: null,\r\n            type: cc.Label,\r\n            displayName: \"经验值\"\r\n        },\r\n\r\n        levelUp: {\r\n            default: null,\r\n            type: cc.Node,\r\n            displayName: \"升级\"\r\n        },\r\n\r\n        expProgress: {\r\n            default: null,\r\n            type: cc.ProgressBar,\r\n            displayName: \"进度条\"\r\n        },\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.init();\r\n    },\r\n\r\n    init: function () {\r\n        this.index = 0;\r\n        this.step = -1;\r\n\r\n        this.listInfo = [];\r\n        this.expNode = this.expNum.node;\r\n\r\n        this.levelUp.scale = 0;\r\n        this.expNode.scale = 0;\r\n        this.goldNode.scale = 0;\r\n        this.crystalNode.scale = 0;\r\n\r\n        this.levelUp.active = false;\r\n        this.expNode.active = false;\r\n        this.goldNode.active = false;\r\n        this.crystalNode.active = false;\r\n        this.expProgress.node.active = false;\r\n\r\n        this.intervalTime = 0.05;\r\n        this.durationTime = 0;\r\n    },\r\n\r\n    setExpProgressY: function (posY) {\r\n        this.expProgress.node.y = posY;\r\n    },\r\n\r\n    showGain: function (gainInfo) {\r\n\r\n        this.expNum.string = \"+\" + gainInfo.expAdd + \"经验\";\r\n        var pos = 0;\r\n        if (gainInfo.goldAdd) {\r\n            this.goldNum.string = \"+\" + gainInfo.goldAdd;\r\n            pos = 1\r\n            this.goldNode.active = true;\r\n        }\r\n        if (gainInfo.crystalAdd) {\r\n            this.crystalNum.string = \"+\" + gainInfo.crystalAdd;\r\n            this.crystalNode.y = 120 + pos * 40;\r\n            this.crystalNode.active = true;\r\n        }\r\n        this.node.active = true;\r\n        this.expProgress.node.active = false;\r\n\r\n        this.index = 0;\r\n        this.step = 1;\r\n        var self = this;\r\n\r\n        this.expNum.node.runAction(cc.sequence(\r\n            cc.delayTime(1.0),\r\n            cc.callFunc(function () {\r\n                self.goldNode.active = false;\r\n                self.crystalNode.active = false;\r\n            })));\r\n    },\r\n\r\n    showExp: function (listInfo) {\r\n        this.listInfo = listInfo;\r\n        this.index = 0;\r\n        this.step = 1;\r\n\r\n        var self = this;\r\n\r\n        self.expNode.active = true;\r\n        self.expNode.scale = 0;\r\n        this.showAction(this.expNode, function () {\r\n            self.expProgress.node.active = true;\r\n            self.durationTime = self.intervalTime;\r\n        });\r\n    },\r\n\r\n    showAction: function (node, callBack) {\r\n        node.active = true;\r\n        node.scale = 0;\r\n\r\n        var self = this;\r\n        var act = cc.sequence(\r\n            cc.callFunc(function (target) {\r\n                self.step = 1;\r\n            }),\r\n            cc.spawn(\r\n                cc.scaleTo(0.6, 1).easing(cc.easeBackOut()),\r\n                cc.delayTime(0.6),\r\n            ),\r\n            cc.delayTime(0.4),\r\n            cc.callFunc(function (target) {\r\n                self.step = 2;\r\n                node.scale = 0;\r\n                callBack && callBack();\r\n            }),\r\n        );\r\n        node.runAction(act);\r\n    },\r\n\r\n    update: function (dt) {\r\n        if (this.step !== 2) { return; }\r\n\r\n        this.durationTime += dt;\r\n        if (this.durationTime < this.intervalTime) { return; }\r\n\r\n        this.durationTime = 0;\r\n        if (this.index >= this.listInfo.length) { return; }\r\n\r\n        let percent = this.listInfo[this.index];\r\n        if (1 === percent) {\r\n            this.node.parent.getComponent('PlayerPrefab').playLevelupAni();\r\n            this.showAction(this.levelUp);\r\n        }\r\n        this.expProgress.progress = percent;\r\n        this.index++;\r\n    },\r\n\r\n});\r\n"]}
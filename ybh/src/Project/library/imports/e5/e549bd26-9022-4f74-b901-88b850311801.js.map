{"version":3,"sources":["../../../../../../assets/hall/ui/scene/assets/hall/ui/scene/HallPointScene.js"],"names":["cc","Class","extends","Component","properties","content","Node","scrolldoctView","prefab_page","prefab_item","prefab_doct","asset_lock","SpriteFrame","asset_gift","asset_curr","asset_unlock","asset_docts","onLoad","playerData","AF","GameData","getMyPlayerData","pointId","gold","savePlayerData","totalPage","console","log","util","getUserInfo","initPages","onEnable","EventDispatcher","emit","Event","SCENE_LOADED","node_page","node_item","currentPage","Math","ceil","node_pages","i","instantiate","parent","k","active","updatePage","push","on","EventType","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","TOUCH_CANCEL","initDoct","x","pageIndex","defaultPage","children","forEach","node","index","id","sprite","getComponent","Sprite","Label","string","toString","spriteFrame","name","startCB","e","refreshingFlag","scorllFlag","event","moving","touchMoved","loc","touch","getLocation","start","getStartLocation","move","abs","y","stopPropagation","getDelta","width","dx","pop","unshift","runAction","sequence","moveTo","v2","delayTime","callFunc","shift","min","onBackButtonClick","custom","gotoScene","onItemClick","parseInt","target","openDialog"],"mappings":"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","file":"HallPointScene.js","sourceRoot":"../../../../../../assets/hall/ui/scene","sourcesContent":["\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        content: cc.Node, // 滚动条内容\r\n        scrolldoctView: cc.Node,  // 底部画布\r\n\r\n        prefab_page: cc.Node,\r\n        prefab_item: cc.Node,\r\n        prefab_doct: cc.Node,\r\n\r\n        asset_lock: cc.SpriteFrame,\r\n        asset_gift: cc.SpriteFrame,\r\n        asset_curr: cc.SpriteFrame,\r\n        asset_unlock: cc.SpriteFrame,\r\n\r\n        asset_docts: [cc.SpriteFrame],\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad: function () {\r\n        let playerData = AF.GameData.getMyPlayerData()\r\n        if(playerData.pointId == null){\r\n            playerData.pointId = 0\r\n            playerData.gold = 0\r\n            AF.GameData.savePlayerData(playerData);\r\n        }\r\n        this.pointId = playerData.pointId\r\n        this.totalPage = 9\r\n        console.log('AF.util.getUserInfo() = ', AF.util.getUserInfo())\r\n        this.initPages()\r\n    },\r\n\r\n    onEnable:function() {\r\n        AF.EventDispatcher.emit(AF.Event.SCENE_LOADED);\r\n    },\r\n\r\n    initPages() {\r\n        let node_page, node_item\r\n        this.currentPage = Math.ceil((this.pointId + 1) / 50) - 1\r\n        this.currentPage = this.currentPage > this.totalPage ? this.totalPage : this.currentPage\r\n        this.node_pages = []\r\n        for (let i = 0; i < 3; i++) {\r\n            node_page = cc.instantiate(this.prefab_page)\r\n            node_page.parent = this.content\r\n            for (let k = 0; k < 50; k++) {\r\n                node_item = cc.instantiate(this.prefab_item)\r\n                node_item.parent = node_page\r\n                node_item.active = true\r\n            }\r\n            this.updatePage(node_page, this.currentPage - 1 + i)\r\n            this.node_pages.push(node_page)\r\n        }\r\n\r\n        this.content.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this, true)\r\n        this.content.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this, true)\r\n        this.content.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this, true)\r\n        this.initDoct()\r\n\r\n        this.content.x = -this.currentPage * 500\r\n    },\r\n\r\n    updatePage(node_page, pageIndex) {\r\n        let defaultPage = Math.ceil((this.pointId + 1) / 50) - 1\r\n        if (pageIndex < 0 || pageIndex > this.currentPage + 1 || pageIndex > this.totalPage || pageIndex > defaultPage + 1) {\r\n            node_page.active = false\r\n            return\r\n        }\r\n        node_page.children.forEach((node, index) => {\r\n            let id = pageIndex * 50 + index + 1;\r\n            let sprite = node.getComponent(cc.Sprite)\r\n            node.children[0].getComponent(cc.Label).string = id.toString()\r\n            if (id <= this.pointId) {\r\n                if (sprite.spriteFrame !== this.asset_unlock) {\r\n                    sprite.spriteFrame = this.asset_unlock//已通过\r\n                }\r\n            } else if (id === this.pointId + 1) {\r\n                if (sprite.spriteFrame !== this.asset_curr) {\r\n                    sprite.spriteFrame = this.asset_curr//当前挑战\r\n                }\r\n            } else if (id > this.pointId + 1) {\r\n                if (id % 25 === 0) {\r\n                    if (sprite.spriteFrame !== this.asset_gift) {\r\n                        node.children[0].getComponent(cc.Label).string = ''\r\n                        sprite.spriteFrame = this.asset_gift//礼物\r\n                    }\r\n                } else if (sprite.spriteFrame !== this.asset_lock) {\r\n                    sprite.spriteFrame = this.asset_lock//无法挑战\r\n                }\r\n            }\r\n            node.name = id.toString()\r\n        });\r\n        node_page.x = 500 * pageIndex\r\n        node_page.active = true\r\n    },\r\n\r\n    // 监听滚动条开始滚动\r\n    startCB(e) {\r\n        if (!this.refreshingFlag) {\r\n            this.scorllFlag = true;\r\n        }\r\n    },\r\n\r\n    onTouchMove(event) {\r\n        if (this.moving) {\r\n            return\r\n        }\r\n        //FIXME: touch move delta should be calculated by DPI.\r\n        if (!this.touchMoved) {\r\n            let loc = event.touch.getLocation()\r\n            let start = event.touch.getStartLocation()\r\n            let touch = event.touch;\r\n            let move = Math.abs(start.x - loc.x) > 5 || Math.abs(start.y - loc.y) > 5\r\n            if (move) {\r\n                this.touchMoved = true\r\n                event.stopPropagation()\r\n            }\r\n        }\r\n        let x = event.touch.getDelta().x + this.content.x\r\n        x = x > 0 ? 0 : x\r\n        x = x < -this.content.width + 475 ? -this.content.width + 475 : x\r\n        this.content.x = x\r\n    },\r\n\r\n    // 监听滚动条结束滚动\r\n    onTouchEnd(e) {\r\n        if (this.moving) {\r\n            return\r\n        }\r\n        if (this.touchMoved) {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        let node_page\r\n        let dx = -this.content.x - this.currentPage * 500\r\n        if (dx < -50) {\r\n            if (this.currentPage <= 0) {\r\n                return\r\n            }\r\n            this.currentPage -= 1\r\n            node_page = this.node_pages.pop()\r\n            this.node_pages.unshift(node_page)\r\n            this.moving = true\r\n            this.content.runAction(cc.sequence(\r\n                cc.moveTo(0.3, cc.v2(-this.currentPage * 500, 0)),\r\n                cc.delayTime(0.1),\r\n                cc.callFunc(() => {\r\n                    this.moving = false\r\n                    this.touchMoved = false\r\n                    this.updatePage(node_page, this.currentPage - 1)\r\n                }, this.node)\r\n            ))\r\n        } else if (dx > 50) {\r\n            let defaultPage = Math.ceil((this.pointId + 1) / 50) - 1\r\n            if (this.currentPage >= this.totalPage || this.currentPage >= defaultPage + 1) {\r\n                return\r\n            }\r\n            this.currentPage += 1\r\n            node_page = this.node_pages.shift()\r\n            this.node_pages.push(node_page)\r\n            this.moving = true\r\n            this.content.runAction(cc.sequence(\r\n                cc.moveTo(0.3, cc.v2(-this.currentPage * 500, 0)),\r\n                cc.delayTime(0.1),\r\n                cc.callFunc(() => {\r\n                    this.moving = false\r\n                    this.touchMoved = false\r\n                    this.updatePage(node_page, this.currentPage + 1)\r\n                }, this.node)\r\n            ))\r\n        } else if (dx != 0) {\r\n            this.touchMoved = false\r\n            this.content.runAction(cc.moveTo(0.1, cc.v2(-this.currentPage * 500, 0)))\r\n        } else {\r\n            this.touchMoved = false\r\n            return\r\n        }\r\n        this.initDoct()\r\n    },\r\n\r\n    // 画底部小圆点 & 更新\r\n    initDoct() {\r\n        let totalPage = Math.min(Math.ceil((this.pointId + 1) / 50), this.totalPage)\r\n        for (let i = 0; i <= totalPage; i++) {\r\n            let node = null;\r\n            if (this.scrolldoctView.children[i]) {\r\n                node = this.scrolldoctView.children[i]\r\n            }\r\n            else {\r\n                node = cc.instantiate(this.prefab_doct)\r\n                node.parent = this.scrolldoctView\r\n                node.active = true\r\n            }\r\n            if (i !== this.currentPage) {\r\n                node.getComponent(cc.Sprite).spriteFrame = this.asset_docts[0]\r\n            } else {\r\n                node.getComponent(cc.Sprite).spriteFrame = this.asset_docts[1]\r\n            }\r\n        }\r\n    },\r\n\r\n    onBackButtonClick: function (event, custom) {\r\n        AF.gotoScene('HallMainScene');\r\n    },\r\n\r\n    onItemClick(e) {\r\n        let id = parseInt(e.target.name);\r\n        if (id <= this.pointId + 1) {\r\n            AF.openDialog(\"HallGameDialog\", { pointId: id });\r\n        }\r\n    },\r\n});\r\n"]}
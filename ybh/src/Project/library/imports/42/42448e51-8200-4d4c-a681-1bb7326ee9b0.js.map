{"version":3,"sources":["../../../../../../assets/hall/ui/widget/assets/hall/ui/widget/LoadingLayer.js"],"names":["cc","Class","extends","Component","properties","panel","Node","actionTag","default","visible","tips","type","RichText","defaultHideTime","onLoad","node","zIndex","AF","Const","LOADING_LAYER_Z_ORDER","width","winSize","height","EventDispatcher","on","Event","SHOW_LOADING_LAYER","show","HIDE_LOADING_LAYER","hide","onDestroy","off","setTips","string","params","opacity","active","delayTiem","hideTime","Math","max","self","stopActionByTag","seq","sequence","delayTime","fadeIn","callFunc","setTag","runAction"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;;AAERC,eAAOL,GAAGM,IAFF;;AAIRC,mBAAW;AACPC,qBAAS,IADF;AAEPC,qBAAS;AAFF,SAJH;;AASRC,cAAM;AACFF,qBAAS,IADP;AAEFG,kBAAMX,GAAGY;AAFP,SATE;;AAcRC,yBAAiB;AACbL,qBAAS;AADI;AAdT,KAHP;;AAsBLM,YAAQ,kBAAY;AAChB;AACA,aAAKC,IAAL,CAAUC,MAAV,GAAmBC,GAAGC,KAAH,CAASC,qBAA5B;;AAEA,aAAKd,KAAL,CAAWe,KAAX,GAAmBpB,GAAGqB,OAAH,CAAWD,KAA9B;AACA,aAAKf,KAAL,CAAWiB,MAAX,GAAoBtB,GAAGqB,OAAH,CAAWC,MAA/B;;AAEAL,WAAGM,eAAH,CAAmBC,EAAnB,CAAsBP,GAAGQ,KAAH,CAASC,kBAA/B,EAAmD,KAAKC,IAAxD,EAA8D,IAA9D;AACAV,WAAGM,eAAH,CAAmBC,EAAnB,CAAsBP,GAAGQ,KAAH,CAASG,kBAA/B,EAAmD,KAAKC,IAAxD,EAA8D,IAA9D;AACH,KA/BI;;AAiCLC,eAAW,qBAAY;;AAEnBb,WAAGM,eAAH,CAAmBQ,GAAnB,CAAuBd,GAAGQ,KAAH,CAASC,kBAAhC,EAAoD,KAAKC,IAAzD,EAA+D,IAA/D;AACAV,WAAGM,eAAH,CAAmBQ,GAAnB,CAAuBd,GAAGQ,KAAH,CAASG,kBAAhC,EAAoD,KAAKC,IAAzD,EAA+D,IAA/D;AACH,KArCI;;AAuCLG,aAAS,iBAAUtB,IAAV,EAAgB;AACrB,YAAI,CAACA,IAAL,EAAW;AACP;AACH;;AAED,YAAI,CAAC,KAAKA,IAAV,EAAgB;AAChB,aAAKA,IAAL,CAAUuB,MAAV,GAAmBvB,IAAnB;AACH,KA9CI;;AAgDLiB,UAAM,cAAUO,MAAV,EAAkB;AACpB,aAAKnB,IAAL,CAAUoB,OAAV,GAAoB,CAApB;AACA,aAAKpB,IAAL,CAAUqB,MAAV,GAAmB,IAAnB;AACA,aAAKrB,IAAL,CAAUC,MAAV,GAAmBC,GAAGC,KAAH,CAASC,qBAA5B;;AAEA,YAAIkB,YAAY,CAAhB;AACA,YAAIH,MAAJ,EAAY;AACRG,wBAAYH,OAAOI,QAAP,IAAmB,KAAKzB,eAApC;AACA,iBAAKmB,OAAL,CAAaE,OAAOxB,IAApB;AACH;AACD2B,oBAAYE,KAAKC,GAAL,CAAS,CAAT,EAAYH,YAAY,GAAxB,CAAZ;;AAEA,YAAII,OAAO,IAAX;AACA,YAAI1B,OAAO,KAAKA,IAAhB;AACAA,aAAK2B,eAAL,CAAqB,KAAKnC,SAA1B;AACA,YAAIoC,MAAM3C,GAAG4C,QAAH,CACN5C,GAAG6C,SAAH,CAAa,GAAb,CADM,EAEN7C,GAAG8C,MAAH,CAAU,GAAV,CAFM,EAGN9C,GAAG6C,SAAH,CAAaR,SAAb,CAHM,EAINrC,GAAG+C,QAAH,CAAY,YAAY;AACpBN,iBAAKZ,IAAL;AACH,SAFD,CAJM,CAAV;AAQAc,YAAIK,MAAJ,CAAWP,KAAKlC,SAAhB;AACAQ,aAAKkC,SAAL,CAAeN,GAAf;AACH,KAzEI;;AA2ELd,UAAM,gBAAY;AACd,aAAKd,IAAL,CAAU2B,eAAV,CAA0B,KAAKnC,SAA/B;AACA,aAAKQ,IAAL,CAAUqB,MAAV,GAAmB,KAAnB;AACA,aAAKrB,IAAL,CAAUoB,OAAV,GAAoB,CAApB;AACH;AA/EI,CAAT","file":"LoadingLayer.js","sourceRoot":"../../../../../../assets/hall/ui/widget","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        panel: cc.Node,\r\n\r\n        actionTag: {\r\n            default: 1298,\r\n            visible: false\r\n        },\r\n\r\n        tips: {\r\n            default: null,\r\n            type: cc.RichText,\r\n        },\r\n\r\n        defaultHideTime: {\r\n            default: 10\r\n        },\r\n    },\r\n\r\n    onLoad: function () {\r\n        // cc.game.addPersistRootNode(this.node);\r\n        this.node.zIndex = AF.Const.LOADING_LAYER_Z_ORDER;\r\n\r\n        this.panel.width = cc.winSize.width;\r\n        this.panel.height = cc.winSize.height;\r\n\r\n        AF.EventDispatcher.on(AF.Event.SHOW_LOADING_LAYER, this.show, this);\r\n        AF.EventDispatcher.on(AF.Event.HIDE_LOADING_LAYER, this.hide, this);\r\n    },\r\n\r\n    onDestroy: function () {\r\n\r\n        AF.EventDispatcher.off(AF.Event.SHOW_LOADING_LAYER, this.show, this);\r\n        AF.EventDispatcher.off(AF.Event.HIDE_LOADING_LAYER, this.hide, this);\r\n    },\r\n\r\n    setTips: function (tips) {\r\n        if (!tips) {\r\n            return;\r\n        }\r\n        \r\n        if (!this.tips) return;\r\n        this.tips.string = tips;\r\n    },\r\n\r\n    show: function (params) {\r\n        this.node.opacity = 0;\r\n        this.node.active = true;\r\n        this.node.zIndex = AF.Const.LOADING_LAYER_Z_ORDER;\r\n\r\n        var delayTiem = 1;\r\n        if (params) {\r\n            delayTiem = params.hideTime || this.defaultHideTime;\r\n            this.setTips(params.tips);\r\n        }\r\n        delayTiem = Math.max(1, delayTiem - 0.5);\r\n\r\n        var self = this;\r\n        var node = this.node;\r\n        node.stopActionByTag(this.actionTag);\r\n        var seq = cc.sequence(\r\n            cc.delayTime(0.2),\r\n            cc.fadeIn(0.3),\r\n            cc.delayTime(delayTiem),\r\n            cc.callFunc(function () {\r\n                self.hide();\r\n            })\r\n        );\r\n        seq.setTag(self.actionTag);\r\n        node.runAction(seq);\r\n    },\r\n\r\n    hide: function () {\r\n        this.node.stopActionByTag(this.actionTag);\r\n        this.node.active = false;\r\n        this.node.opacity = 0;\r\n    },\r\n});"]}
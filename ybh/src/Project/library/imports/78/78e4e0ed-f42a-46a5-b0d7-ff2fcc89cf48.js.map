{"version":3,"sources":["../../../../../../assets/framework/ui/widget/assets/framework/ui/widget/AFDiceBoxItem.js"],"names":["cc","Class","extends","Component","properties","onLoad","listen","listenFilename","sprite","node","addComponent","Sprite","setItemId","id","localFilename","setFileName","setMapId","mapId","Array","join","slice","init","AF","EventDispatcher","on","Event","FILE_DOWNLOAD","onFileDownloaded","FILE_LOADNETSPRITE","onFrameLoaded","filename","clearUI","isLoaded","util","isLocalFileExist","NetSpriteloader","startLoadNetSprite","Downloader","startDownloadFile","active","onDestroy","off","url","spriteFrame","succ","creatSprite","checkLoaded"],"mappings":"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","file":"AFDiceBoxItem.js","sourceRoot":"../../../../../../assets/framework/ui/widget","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.listen = false;\r\n        this.listenFilename = \"\";\r\n        this.sprite = this.node.addComponent(cc.Sprite);\r\n    },\r\n\r\n    setItemId: function (id) {\r\n        var localFilename = \"StoreUI/dicebox/\" + id + \".png\";\r\n        this.setFileName(localFilename);\r\n    },\r\n\r\n    setMapId: function (mapId) {\r\n        var localFilename = \"map/\" + (Array(2).join(0) + mapId).slice(-2) + \".jpg\";\r\n        this.setFileName(localFilename);\r\n    },\r\n\r\n    // setCloudId: function (cloudId) {\r\n    //     var localFilename = \"map/\" + (Array(2).join(0) + mapId).slice(-2) + \".png\";\r\n    //     this.setFileName(localFilename);\r\n    // },\r\n\r\n    init: function () {\r\n        if (!this.listen) {\r\n            AF.EventDispatcher.on(AF.Event.FILE_DOWNLOAD, this.onFileDownloaded, this);\r\n            AF.EventDispatcher.on(AF.Event.FILE_LOADNETSPRITE, this.onFrameLoaded, this);\r\n            this.listen = true;\r\n        }\r\n    },\r\n\r\n    setFileName: function (filename) {\r\n        this.clearUI();\r\n        this.init();\r\n        this.isLoaded = false;\r\n\r\n        this.listenFilename = filename;\r\n\r\n        if (AF.util.isLocalFileExist(filename)) {\r\n            AF.NetSpriteloader.startLoadNetSprite(filename);\r\n        } else {\r\n            AF.Downloader.startDownloadFile(filename);\r\n        }\r\n    },\r\n\r\n    clearUI: function () {\r\n        this.listenFilename = \"\";\r\n        this.node.active = false;\r\n    },\r\n\r\n    onDestroy: function () {\r\n        if (this.listen) {\r\n            this.listen = false;\r\n            this.listenFilename = \"\";\r\n            AF.EventDispatcher.off(AF.Event.FILE_DOWNLOAD, this.onFileDownloaded, this);\r\n            AF.EventDispatcher.off(AF.Event.FILE_LOADNETSPRITE, this.onFrameLoaded, this);\r\n        }\r\n    },\r\n\r\n    onFileDownloaded: function (filename, url) {\r\n        if (this.listenFilename !== filename) {\r\n            return;\r\n        }\r\n        AF.NetSpriteloader.startLoadNetSprite(filename);\r\n    },\r\n\r\n    onFrameLoaded: function (filename, spriteFrame, succ) {\r\n        if (this.listenFilename !== filename) return;\r\n\r\n        if (!succ || !spriteFrame) return;\r\n        this.creatSprite(spriteFrame);\r\n    },\r\n\r\n    creatSprite: function (spriteFrame) {\r\n        this.node.active = true;\r\n        this.sprite.spriteFrame = spriteFrame;\r\n        this.listenFilename = \"\";\r\n        this.isLoaded = true;\r\n    },\r\n    checkLoaded: function () {\r\n        return this.isLoaded;\r\n    },\r\n});\r\n"]}
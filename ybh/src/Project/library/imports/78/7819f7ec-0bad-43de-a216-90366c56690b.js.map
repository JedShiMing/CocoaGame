{"version":3,"sources":["../../../../../../assets/hall/ui/platformViews/assets/hall/ui/platformViews/FriendPassedView.js"],"names":["itemWidth","cc","Class","extends","Component","properties","qqCon","Node","heads","wxDisplay","onLoad","self","active","onEnable","AF","EventDispatcher","on","updatePoint","onDisable","off","pointId","platform","isWxApp","util","postMessage","isAllScreen","height","winSize","isQQApp","getRankList","list","updateHeads","node","i","length","score","getComponent","setPhoto","url"],"mappings":";;;;;;AAAA,IAAMA,YAAY,EAAlB;;AAEAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,eAAOL,GAAGM,IADF;AAERC,eAAO,CAACP,GAAGM,IAAJ,CAFC;AAGRE,mBAAWR,GAAGM;AAHN,KAHP;;AASL;AACAG,YAAQ,kBAAY;AAChB,YAAIC,OAAO,IAAX;AACAA,aAAKL,KAAL,CAAWM,MAAX,GAAoB,KAApB;AACH,KAbI;AAcLC,cAAU,oBAAY;AAClBC,WAAGC,eAAH,CAAmBC,EAAnB,CAAsB,oBAAtB,EAA4C,KAAKC,WAAjD,EAA8D,IAA9D;AAEH,KAjBI;AAkBLC,eAAW,qBAAY;AACnBJ,WAAGC,eAAH,CAAmBI,GAAnB,CAAuB,oBAAvB,EAA6C,KAAKF,WAAlD,EAA+D,IAA/D;AACH,KApBI;AAqBLA,iBAAa,qBAAUG,OAAV,EAAmB;AAAA;;AAC5B,YAAIT,OAAO,IAAX;AACA,YAAIG,GAAGO,QAAH,CAAYC,OAAZ,EAAJ,EAA2B;AACvBR,eAAGS,IAAH,CAAQC,WAAR,CAAoB,CAApB,EAAuB,EAAEJ,gBAAF,EAAWK,aAAaX,GAAGS,IAAH,CAAQE,WAAR,EAAxB,EAA+CC,QAAQzB,GAAG0B,OAAH,CAAWD,MAAlE,EAAvB;AACH,SAFD,MAGK,IAAIZ,GAAGO,QAAH,CAAYO,OAAZ,EAAJ,EAA2B;AAC5B,iBAAKtB,KAAL,CAAWM,MAAX,GAAoB,IAApB;AACAE,eAAGS,IAAH,CAAQM,WAAR,CAAoB,gBAAQ;AACxB,oBAAIC,IAAJ,EAAU;AACN,0BAAKA,IAAL,GAAYA,IAAZ;AACA,0BAAKC,WAAL,CAAiBX,OAAjB;AACH;AACJ,aALD;AAMH;AACJ,KAnCI;AAoCLW,iBAAa,qBAAUX,OAAV,EAAmB;AAC5B,YAAI,CAAC,KAAKY,IAAN,IAAc,CAAC,KAAKA,IAAL,CAAUpB,MAA7B,EAAqC;AACjC;AACH;AACD,aAAK,IAAIqB,IAAI,CAAb,EAAgBA,IAAI,CAAJ,IAASA,IAAI,KAAKH,IAAL,CAAUI,MAAvC,EAA+CD,GAA/C,EAAoD;AAChD,gBAAI,KAAKH,IAAL,CAAUG,CAAV,EAAaE,KAAb,IAAsBf,OAA1B,EAAmC;AAC/B,qBAAKZ,KAAL,CAAWyB,CAAX,EAAcrB,MAAd,GAAuB,IAAvB;AACA,qBAAKJ,KAAL,CAAWyB,CAAX,EAAcG,YAAd,CAA2B,aAA3B,EAA0CC,QAA1C,CAAmD,KAAKP,IAAL,CAAUG,CAAV,EAAaK,GAAhE;AACH,aAHD,MAGO;AACH;AACH;AACJ;AACJ;AAhDI,CAAT","file":"FriendPassedView.js","sourceRoot":"../../../../../../assets/hall/ui/platformViews","sourcesContent":["const itemWidth = 90\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        qqCon: cc.Node,\r\n        heads: [cc.Node],\r\n        wxDisplay: cc.Node,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad: function () {\r\n        let self = this\r\n        self.qqCon.active = false\r\n    },\r\n    onEnable: function () {\r\n        AF.EventDispatcher.on('UpdateFriendPassed', this.updatePoint, this)\r\n\r\n    },\r\n    onDisable: function () {\r\n        AF.EventDispatcher.off('UpdateFriendPassed', this.updatePoint, this)\r\n    },\r\n    updatePoint: function (pointId) {\r\n        let self = this\r\n        if (AF.platform.isWxApp()) {\r\n            AF.util.postMessage(3, { pointId, isAllScreen: AF.util.isAllScreen(), height: cc.winSize.height });\r\n        }\r\n        else if (AF.platform.isQQApp()) {\r\n            this.qqCon.active = true\r\n            AF.util.getRankList(list => {\r\n                if (list) {\r\n                    this.list = list\r\n                    this.updateHeads(pointId)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    updateHeads: function (pointId) {\r\n        if (!this.node || !this.node.active) {\r\n            return\r\n        }\r\n        for (let i = 0; i < 3 && i < this.list.length; i++) {\r\n            if (this.list[i].score >= pointId) {\r\n                this.heads[i].active = true\r\n                this.heads[i].getComponent(\"PhotoPrefab\").setPhoto(this.list[i].url);\r\n            } else {\r\n                break\r\n            }\r\n        }\r\n    }\r\n})\r\n\r\n\r\n\r\n"]}
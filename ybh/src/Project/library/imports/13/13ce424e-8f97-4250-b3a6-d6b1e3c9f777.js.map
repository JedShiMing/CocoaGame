{"version":3,"sources":["../../../../../assets/framework/logic/assets/framework/logic/af-game-data.js"],"names":["GameData","init","userId","userName","headUrl","time","remote","local","players","player_index","myObjects","dialogOnce","getDialogOnce","key","setDialogOnce","AF","util","getCurrTime","initDialogOnce","initGold","EventDispatcher","emit","Event","USER_INFO_UPDATE","setMyObject","data","getMyObject","setTime","remoteTime","Math","floor","getCurrTimeOfSecond","getServerTime","d","localTime","getPastTime","currentTime","setUserId","getUserId","setUserName","getUserName","setHeadUrl","getHeadUrl","getMyPlayerData","playerData","pointId","gold","playerDataStr","getStorage","JSON","parse","setMyPlayerData","savePlayerData","stringify","setStorage","module","exports"],"mappings":"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","file":"af-game-data.js","sourceRoot":"../../../../../assets/framework/logic","sourcesContent":["/**\r\n * 游戏配置\r\n */\r\n\r\nvar GameData = {\r\n\r\n    init: function () {\r\n        this.userId = \"\";          //我的uid\r\n        this.userName = \"\";        //我的微信名\r\n        this.headUrl = \"\";         //我的头像Url\r\n        this.time = { remote: 0, local: 0 };\r\n\r\n        this.players = [];\r\n        this.player_index = {};\r\n\r\n        this.myObjects = {};\r\n        this.dialogOnce = {};\r\n    },\r\n\r\n    getDialogOnce: function (key) {\r\n        if (this.dialogOnce[key]) {\r\n            return this.dialogOnce[key];\r\n        } else {\r\n            return 0;\r\n        }\r\n    },\r\n\r\n    setDialogOnce: function (key) {\r\n        this.dialogOnce[key] = AF.util.getCurrTime();\r\n    },\r\n\r\n    initDialogOnce: function () {\r\n        this.dialogOnce = {};\r\n    },\r\n\r\n    initGold: function () {\r\n        AF.EventDispatcher.emit(AF.Event.USER_INFO_UPDATE);\r\n    },\r\n\r\n    setMyObject: function (key, data) {\r\n        this.myObjects[key] = data;\r\n    },\r\n\r\n    getMyObject: function (key) {\r\n        return this.myObjects[key];\r\n    },\r\n\r\n    setTime: function (remoteTime) {\r\n        this.time.remote = Math.floor(remoteTime / 1000);\r\n        this.time.local = AF.util.getCurrTimeOfSecond();\r\n    },\r\n\r\n    getServerTime: function () {\r\n        var d = 0;\r\n        var localTime = AF.util.getCurrTimeOfSecond();\r\n        if (localTime > this.time.local) {\r\n            d = localTime - this.time.local;\r\n        }\r\n        return this.time.remote + d;\r\n    },\r\n\r\n    getPastTime: function (remoteTime) {\r\n\r\n        var currentTime = AF.GameData.getServerTime();\r\n        if (currentTime <= remoteTime) {\r\n            return 0;\r\n        }\r\n\r\n        return currentTime - remoteTime;\r\n    },\r\n\r\n    setUserId: function (userId) {\r\n        this.userId = userId;\r\n    },\r\n\r\n    getUserId: function () {\r\n        return this.userId;\r\n    },\r\n\r\n    setUserName(userName) {\r\n        this.userName = userName;\r\n    },\r\n\r\n    getUserName: function () {\r\n        return this.userName;\r\n    },\r\n\r\n    setHeadUrl: function (headUrl) {\r\n        this.headUrl = headUrl;\r\n    },\r\n\r\n    getHeadUrl: function () {\r\n        return this.headUrl;\r\n    },\r\n\r\n    getMyPlayerData: function () {\r\n        if (this.playerData) {\r\n            return this.playerData;\r\n        }\r\n\r\n        this.playerData = {\r\n            // preScore: 0,//存储当前分数\r\n            // playCount: 0,//存储次数\r\n            // totalScore: 0,//存储总分数\r\n            // bestScore: 0,//存储最高分\r\n            pointId: 0,\r\n            gold: 0,\r\n        };\r\n        var playerDataStr = AF.util.getStorage('player_data');\r\n        if (playerDataStr) {\r\n            this.playerData = JSON.parse(playerDataStr);\r\n        }\r\n        return this.playerData;\r\n    },\r\n\r\n    setMyPlayerData: function (playerData) {\r\n        this.playerData = playerData;\r\n    },\r\n\r\n    savePlayerData: function () {\r\n        let playerDataStr = JSON.stringify(this.playerData);\r\n        AF.util.setStorage(\"player_data\", playerDataStr);\r\n    },\r\n};\r\n\r\nGameData.init();\r\n\r\nAF.GameData = module.exports = GameData;\r\n\r\n"]}